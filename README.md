# RemoteMSIUninstaller

This PowerShell code to remove instances of an MSI installed on a remote computer originally came about as I needed to uninstall a lot of QuickTime components before installing the newer version. Though, shortly after beginning this, QuickTime was no longer being produced for the PC, so the development was put on hold. It was only until recently when a friend of mine was going to a site that wanted some MSI based software removed off all of their computers... with no idea if or how they were managed, or if there were different versions floating about... that I dusted off this coding.

So how does this work? Well... it searches for all the entries of a DisplayName you provide at the top of the script, within in the registry (under the Local Machine uninstall keys for 32 bit `HKLM:\Software\Wow6432Node\Microsoft\Windows\CurrentVersion\Uninstall` and 64 bit `HKLM:\Software\Microsoft\Windows\CurrentVersion\Uninstall`), finds the uninstall string to remove the program, and amends it to use standard MSI silent switches to remove it.

If you don't know how the product name is formatted, you can have a look thought the 32 bit and 64 bit keys mentioned on a machine with it installed to see what base name it's given that you want to look for.

As you see in this script, the vast majority of coding is in functions, so as we know these parts won't execute until called, so the next part of this script to process is right at the end... which is to clear the screen and run the `funcAdminCheck`... as you will need Admin rights... actually Domain Admin rights when connection to remote computers... to communicate and uninstall software remotely. If you haven't run this script as an Admin, you will be notified that you need to do so. With that out the way, the script will continue to run `funcNewMachine` each time you wish to continue to remove the software from a new machine name.

Here you will be asked for the machine you wish to remove the software from, enter a name and the computer will check to see via `funcDNSVerify` that the machine is pingable, that WMI can connect to the machine, and that the machine name is the one expected just in case there is a DNS issue where the DNS server is giving you stale name records... and if that's the case it might be worth you doing an `ipconfig /flushdns` as an administrator, or scavenging your old DNS records on the server. If the connection fails, you will be informed and asked via `funcQueryNewMachine` to type a new computer name to check if you wish to continue. If the connection works, `funcRemoteUninstall` is then executed.

As part of `funcRemoteUninstall`, the string of `$DisplayName` is added to the argument list to pass over to the scripting block that is set to run on the remote computer, we then immediately run `param($DisplayName)` to ensure this value is set inside the script for later use on the remote machine. First it will check through the 64-Bit uninstall key's subkeys for any instances of the DisplayName and if found it will edit the uninstallation string for the msiexec.exe command to use `/X` (uninstall) instead of `/I` (install), as some installers use `/I` so you can add or remove components, in this case we definitely want to uninstall. Then it will include `/qn` if it isn't set already to quietly uninstall with no interface. After that it will run the command and wait until completion and then repeat this process for the 32-Bit uninstall key. If nothing is found on the machine a message will be shown to that effect. You will then be asked if you wish to uninstall from another computer.
